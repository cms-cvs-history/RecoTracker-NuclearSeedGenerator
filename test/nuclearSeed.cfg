process NUCLEAR =  {
    service = MessageLogger
    {
                untracked vstring destinations = { "cout", "nuclearseeding" } # .log automatically
              #  untracked vstring statistics = { "cout", "nuclearseeding"}

                untracked vstring categories = { "NuclearSeedGenerator", "CkfPattern" }

                untracked PSet nuclearseeding    = { 
                        untracked string threshold = "DEBUG" 
                        untracked PSet DEBUG = { untracked int32 limit = 0 }
                        untracked PSet NuclearSeedGenerator = { untracked int32 limit = -1}
                        untracked PSet CkfPattern = { untracked int32 limit = -1}
                        untracked bool noLineBreaks = true 
                }
                untracked vstring debugModules = { "nuclearSeed", "ckfTrackCandidates" }

                untracked PSet cout  = { 
                        untracked string threshold = "INFO" 
                        untracked PSet INFO = { untracked int32 limit = 0 }
                        untracked PSet WARNING = { untracked int32 limit = 0 }
                        untracked PSet ERROR = { untracked int32 limit = 0 }
                        untracked PSet DEBUG = { untracked int32 limit = 0 }
                        untracked bool noLineBreaks = true 
                }

    }
    
    source = PoolSource 
    { 
      untracked vstring fileNames = { 
#                 'file:/afs/cern.ch/user/r/roberfro/scratch0/CMSSW_1_3_0_pre2/src/Config/test/pi1to200gev14.root',
#                 'file:/afs/cern.ch/user/r/roberfro/scratch0/CMSSW_1_3_0_pre2/src/Config/test/pi1to200gev15.root',
#                 'file:/afs/cern.ch/user/r/roberfro/scratch0/CMSSW_1_3_0_pre2/src/Config/test/pi1to200gev16.root',
#                 'file:/afs/cern.ch/user/r/roberfro/scratch0/CMSSW_1_3_0_pre2/src/Config/test/pi1to200gev17.root'}
#                 'rfio:/castor/cern.ch/user/r/roberfro/CMSSW_1_5_0_pre2/singlepi20gev1.root',
                  'file:/afs/cern.ch/user/r/roberfro/scratch0/CMSSW_1_5_0_pre2/src/Config/test/singlepi20gev1.root',
#                  'file:/afs/cern.ch/user/r/roberfro/scratch0/CMSSW_1_5_0_pre3/src/Config/test/jet120_170.root'}
#                  'file:/afs/cern.ch/user/r/roberfro/scratch0/CMSSW_1_5_0_pre3/src/Config/test/ttbar.root'}
#                  'file:singlepi20gev2.root',
                  'file:/afs/cern.ch/user/r/roberfro/scratch0/CMSSW_1_5_0_pre2/src/Config/test/singlepi20gev3.root',
                  'file:/afs/cern.ch/user/r/roberfro/scratch0/CMSSW_1_5_0_pre2/src/Config/test/singlepi20gev4.root'}
#                 'rfio:/castor/cern.ch/user/r/roberfro/CMSSW_1_5_0_pre2/singlepi20gev2.root',
#                 'rfio:/castor/cern.ch/user/r/roberfro/CMSSW_1_5_0_pre2/singlepi20gev3.root',
#                 'rfio:/castor/cern.ch/user/r/roberfro/CMSSW_1_5_0_pre2/singlepi20gev4.root'}
    }

    untracked PSet maxEvents = {untracked int32 input = 350}

    # For Debugging :
    #---------------
    #Tracking truth
    include "SimGeneral/TrackingAnalysis/data/trackingParticles.cfi"
    replace trackingParticles.HepMCDataLabels = {"source"}

    #Magnetic Field
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
    include "Geometry/CommonDetUnit/data/globalTrackingGeometry.cfi"

    # Refitter
    include "RecoTracker/TrackProducer/data/RefitterWithMaterial.cff"
    replace TrackRefitter.TrajectoryInEvent = true

    # Nuclear Seeding
    include "RecoTracker/NuclearSeedGenerator/data/NuclearSeed.cff"

    # defines ckftracks and rstracks
    include "RecoTracker/Configuration/data/RecoTracker.cff" 
    replace CkfTrajectoryBuilder.minimumNumberOfHits = 3
    replace CkfTrajectoryBuilder.ptCut = 0.2
    replace ckfTrackCandidates.SeedProducer = "nuclearSeed"
    replace ckfTrackCandidates.RedundantSeedCleaner = "none"
    replace KFFittingSmoother.MinNumberOfHits = 3

    module dump = EventContentAnalyzer{}

    module Out = PoolOutputModule
    {
     untracked string fileName = "pi20gev_1.root"
     untracked vstring outputCommands = {
           "drop *",
           "keep *_*_*_NUCLEAR", 
           "keep *_ctfWithMaterialTracks_*_*" 
     } 
    }

   path p = {TrackRefitter, trackingParticles, nuclearSeed, ckfTrackCandidates, ctfWithMaterialTracks} 

   # path p = { dump }

   endpath e = 
   {
     Out
   }
}
